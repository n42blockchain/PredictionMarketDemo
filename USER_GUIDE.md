# é¢„æµ‹å¸‚åœº DApp ä½¿ç”¨æŒ‡å—

## ç›®æ ‡è¯»è€…
æœ¬æŒ‡å—ä¸“ä¸ºç†Ÿæ‚‰æ•°å­—è´§å¸é’±åŒ…æ“ä½œï¼ˆå¦‚ MetaMask è¿æ¥ã€è½¬è´¦ç­‰ï¼‰ä½†ä»æœªä½¿ç”¨è¿‡é¢„æµ‹å¸‚åœºçš„ç”¨æˆ·ç¼–å†™ã€‚

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šä»€ä¹ˆæ˜¯é¢„æµ‹å¸‚åœºï¼Ÿ

### åŸºæœ¬æ¦‚å¿µ

**é¢„æµ‹å¸‚åœº**æ˜¯ä¸€ä¸ªå¯ä»¥å¯¹æœªæ¥äº‹ä»¶è¿›è¡Œé¢„æµ‹å¹¶äº¤æ˜“çš„å¹³å°ã€‚æ‚¨å¯ä»¥æŠŠå®ƒç†è§£ä¸ºï¼š

- **ä¼ ç»Ÿå¯¹æ¯”**ï¼šç±»ä¼¼äºä½“è‚²åšå½©ï¼Œä½†ç”¨äºå„ç§äº‹ä»¶ï¼ˆä¸ä»…é™äºä½“è‚²ï¼‰
- **æ ¸å¿ƒåŸç†**ï¼šå¸‚åœºä»·æ ¼åæ˜ äº†å‚ä¸è€…å¯¹äº‹ä»¶å‘ç”Ÿæ¦‚ç‡çš„é›†ä½“åˆ¤æ–­
- **äº¤æ˜“æœºåˆ¶**ï¼šé€šè¿‡ä¹°å–"ä»½é¢"æ¥è¡¨è¾¾æ‚¨å¯¹äº‹ä»¶ç»“æœçš„çœ‹æ³•

### å·¥ä½œåŸç†ç¤ºä¾‹

å‡è®¾å¸‚åœºé—®é¢˜æ˜¯ï¼š"æ¯”ç‰¹å¸ä¼šåœ¨2026å¹´åº•è¾¾åˆ°$100,000å—ï¼Ÿ"

1. **ä¸¤ç§é€‰æ‹©**ï¼š
   - YESä»½é¢ï¼šè®¤ä¸ºä¼šè¾¾åˆ°
   - NOä»½é¢ï¼šè®¤ä¸ºä¸ä¼šè¾¾åˆ°

2. **ä»·æ ¼å«ä¹‰**ï¼š
   - YESä»·æ ¼ = 60% â†’ å¸‚åœºè®¤ä¸ºæœ‰60%æ¦‚ç‡ä¼šå‘ç”Ÿ
   - NOä»·æ ¼ = 40% â†’ å¸‚åœºè®¤ä¸ºæœ‰40%æ¦‚ç‡ä¸ä¼šå‘ç”Ÿ
   - æ³¨æ„ï¼šYES + NO å§‹ç»ˆ = 100%

3. **ç›ˆåˆ©æ–¹å¼**ï¼š
   - å¦‚æœæ‚¨ä»¥60%çš„ä»·æ ¼ä¹°å…¥YESä»½é¢
   - äº‹ä»¶å‘ç”Ÿåï¼Œæ¯ä»½YESä»½é¢ä»·å€¼100%
   - æ‚¨çš„æ”¶ç›Š = (100% - 60%) = 40%çš„åˆ©æ¶¦

### ä¸æ™®é€šäº¤æ˜“çš„åŒºåˆ«

| ç‰¹æ€§ | é¢„æµ‹å¸‚åœº | æ™®é€šä»£å¸äº¤æ˜“ |
|------|---------|------------|
| äº¤æ˜“æ ‡çš„ | äº‹ä»¶ç»“æœä»½é¢ | ä»£å¸ |
| ä»·æ ¼èŒƒå›´ | 0-100%ï¼ˆæ¦‚ç‡ï¼‰ | æ— ä¸Šé™ |
| ç»“ç®—æ–¹å¼ | æ­£ç¡®é¢„æµ‹è·å¾—1ä»£å¸/ä»½é¢ | å–å‡ºæ—¶å³ç»“ç®— |
| æ—¶é—´é™åˆ¶ | æœ‰ç»“æŸæ—¶é—´ | æ— é™åˆ¶ |

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šç¯å¢ƒå‡†å¤‡

### æ­¥éª¤1ï¼šå‡†å¤‡ MetaMask é’±åŒ…

å¦‚æœæ‚¨å·²ç»æœ‰ MetaMask é’±åŒ…ï¼Œè¯·è·³åˆ°æ­¥éª¤2ã€‚

1. è®¿é—® https://metamask.io/ å®‰è£…é’±åŒ…
2. åˆ›å»ºè´¦æˆ·å¹¶**å®‰å…¨ä¿å­˜åŠ©è®°è¯**
3. ç¡®ä¿æ‚¨ç†è§£ï¼š
   - ç§é’¥/åŠ©è®°è¯æ˜¯æ‚¨èµ„äº§çš„å”¯ä¸€å‡­è¯
   - ä»»ä½•äººè·å–å®ƒéƒ½èƒ½å®Œå…¨æ§åˆ¶æ‚¨çš„èµ„äº§
   - æ²¡æœ‰ä»»ä½•æœºæ„å¯ä»¥å¸®æ‚¨æ‰¾å›

### æ­¥éª¤2ï¼šæ·»åŠ  N42 æµ‹è¯•ç½‘ç»œ

N42 æ˜¯æœ¬é¡¹ç›®è¿è¡Œçš„åŒºå—é“¾ç½‘ç»œã€‚æ·»åŠ æ–¹æ³•æœ‰ä¸¤ç§ï¼š

#### æ–¹æ³•Aï¼šè‡ªåŠ¨æ·»åŠ ï¼ˆæ¨èï¼‰

1. å¯åŠ¨å‰ç«¯åº”ç”¨ï¼ˆè§ä¸‹æ–‡ï¼‰
2. è¿æ¥é’±åŒ…åç‚¹å‡» "Switch to N42" æŒ‰é’®
3. åœ¨ MetaMask å¼¹çª—ä¸­ç¡®è®¤æ·»åŠ ç½‘ç»œ

#### æ–¹æ³•Bï¼šæ‰‹åŠ¨æ·»åŠ 

1. æ‰“å¼€ MetaMask
2. ç‚¹å‡»é¡¶éƒ¨ç½‘ç»œä¸‹æ‹‰èœå•
3. é€‰æ‹© "æ·»åŠ ç½‘ç»œ" â†’ "æ‰‹åŠ¨æ·»åŠ ç½‘ç»œ"
4. å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š

```
ç½‘ç»œåç§°ï¼šN42 Test Network
RPC URLï¼šhttps://testrpc.n42.world
Chain IDï¼š1142
è´§å¸ç¬¦å·ï¼šN
åŒºå—æµè§ˆå™¨URLï¼šhttps://testnet.n42.world/
```

5. ç‚¹å‡»"ä¿å­˜"

### æ­¥éª¤3ï¼šè·å–æµ‹è¯•ä»£å¸

æœ¬é¡¹ç›®éœ€è¦ä¸¤ç§æµ‹è¯•ä»£å¸ï¼š

#### 3.1 è·å– N ä»£å¸ï¼ˆç”¨äºæ”¯ä»˜ Gas è´¹ï¼‰

1. è®¿é—®æ°´é¾™å¤´ï¼šhttps://n42.ai/faucet
2. è¾“å…¥æ‚¨çš„é’±åŒ…åœ°å€
3. å®ŒæˆéªŒè¯ï¼ˆå¦‚æœæœ‰ï¼‰
4. ç‚¹å‡»é¢†å–
5. ç­‰å¾…çº¦10-30ç§’ï¼Œæ£€æŸ¥é’±åŒ…ä½™é¢

**å»ºè®®é¢†å–æ•°é‡**ï¼šè‡³å°‘0.1 Nï¼ˆç”¨äºå¤šæ¬¡äº¤æ˜“çš„Gasè´¹ï¼‰

#### 3.2 è·å– PRED ä»£å¸ï¼ˆç”¨äºå¸‚åœºäº¤æ˜“ï¼‰

PRED æ˜¯æœ¬é¡¹ç›®çš„äº¤æ˜“ä»£å¸ï¼Œæœ‰ä»¥ä¸‹å‡ ç§è·å–æ–¹å¼ï¼š

**æ–¹å¼1ï¼šä½¿ç”¨å‰ç«¯åº”ç”¨ï¼ˆæœ€ç®€å•ï¼‰**

å¯åŠ¨å‰ç«¯åï¼Œåœ¨ç•Œé¢ä¸Šä¼šæœ‰"é¢†å–æµ‹è¯•ä»£å¸"æŒ‰é’®ï¼ˆåŠŸèƒ½å¾…å®ç°ï¼‰

**æ–¹å¼2ï¼šä½¿ç”¨å‘½ä»¤è¡Œè„šæœ¬**

```bash
cd /Users/jieliu/Documents/n42/PredictionMarketDemo
npm run console
```

åœ¨æ§åˆ¶å°ä¸­æ‰§è¡Œï¼š
```javascript
const deployment = require('./deployment.json');
const Token = await ethers.getContractFactory("PredictionToken");
const token = Token.attach(deployment.token);

// é¢†å–100 PRED
await token.claimFromFaucet();

// æ£€æŸ¥ä½™é¢
const balance = await token.balanceOf((await ethers.getSigners())[0].address);
console.log("PREDä½™é¢:", ethers.formatEther(balance));
```

**æ–¹å¼3ï¼šä½¿ç”¨åŒºå—æµè§ˆå™¨**

1. è®¿é—® Token åˆçº¦ï¼šhttps://testnet.n42.world/address/0x38A70c040CA5F5439ad52d0e821063b0EC0B52b6
2. ç‚¹å‡» "Write Contract"
3. è¿æ¥é’±åŒ…
4. æ‰¾åˆ° `claimFromFaucet` å‡½æ•°å¹¶æ‰§è¡Œ

**é‡è¦é™åˆ¶**ï¼š
- æ¯ä¸ªåœ°å€æ¯24å°æ—¶åªèƒ½é¢†å–ä¸€æ¬¡
- æ¯æ¬¡é¢†å–100 PRED
- å¦‚æœæå‰å°è¯•é¢†å–ä¼šæ˜¾ç¤ºé”™è¯¯

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¯åŠ¨å’Œè®¿é—®åº”ç”¨

### å¯åŠ¨å‰ç«¯åº”ç”¨

1. æ‰“å¼€ç»ˆç«¯ï¼Œè¿›å…¥é¡¹ç›®ç›®å½•ï¼š
```bash
cd /Users/jieliu/Documents/n42/PredictionMarketDemo
```

2. è¿›å…¥å‰ç«¯ç›®å½•ï¼š
```bash
cd frontend
```

3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š
```bash
npm run dev
```

4. çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹è¾“å‡ºè¡¨ç¤ºå¯åŠ¨æˆåŠŸï¼š
```
VITE v7.x.x  ready in xxx ms

âœ  Local:   http://localhost:5173/
```

5. åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š**http://localhost:5173/**

### è¿æ¥é’±åŒ…

1. ç‚¹å‡»é¡µé¢å³ä¸Šè§’çš„ "Connect Wallet" æŒ‰é’®
2. MetaMask ä¼šå¼¹å‡ºçª—å£
3. é€‰æ‹©è¦è¿æ¥çš„è´¦æˆ·
4. ç‚¹å‡» "ä¸‹ä¸€æ­¥" â†’ "è¿æ¥"
5. ç¡®ä¿ MetaMask å·²åˆ‡æ¢åˆ° N42 æµ‹è¯•ç½‘ç»œ
6. è¿æ¥æˆåŠŸåï¼ŒæŒ‰é’®ä¼šæ˜¾ç¤ºæ‚¨çš„é’±åŒ…åœ°å€ï¼ˆç®€å†™å½¢å¼ï¼‰

---

## ç¬¬å››éƒ¨åˆ†ï¼šä½¿ç”¨å¸‚åœºè¿›è¡Œäº¤æ˜“

### 4.1 æµè§ˆå¸‚åœºåˆ—è¡¨

è¿›å…¥åº”ç”¨åï¼Œé¦–é¡µæ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„å¸‚åœºã€‚æ¯ä¸ªå¸‚åœºå¡ç‰‡åŒ…å«ï¼š

- **é—®é¢˜**ï¼šé¢„æµ‹çš„äº‹ä»¶æè¿°
- **çŠ¶æ€æ ‡ç­¾**ï¼š
  - ğŸŸ¢ Activeï¼ˆæ´»è·ƒï¼‰ï¼šå¯ä»¥äº¤æ˜“
  - ğŸ”´ Resolvedï¼ˆå·²ç»“ç®—ï¼‰ï¼šå·²ç¡®å®šç»“æœï¼Œä¸å¯äº¤æ˜“
- **å½“å‰ä»·æ ¼**ï¼š
  - YES: xx%ï¼ˆå¸‚åœºå¯¹"æ˜¯"çš„æ¦‚ç‡åˆ¤æ–­ï¼‰
  - NO: yy%ï¼ˆå¸‚åœºå¯¹"å¦"çš„æ¦‚ç‡åˆ¤æ–­ï¼‰
- **å‰©ä½™æ—¶é—´**ï¼šè·ç¦»å¸‚åœºç»“æŸçš„å€’è®¡æ—¶
- **æµåŠ¨æ€§**ï¼šå¸‚åœºä¸­çš„æ€»èµ„é‡‘é‡

### 4.2 è¿›å…¥å¸‚åœºè¯¦æƒ…

1. ç‚¹å‡»ä»»æ„å¸‚åœºå¡ç‰‡
2. è¿›å…¥è¯¦æƒ…é¡µï¼Œå¯ä»¥çœ‹åˆ°ï¼š
   - å®Œæ•´çš„é—®é¢˜æè¿°
   - å®æ—¶ä»·æ ¼å›¾è¡¨
   - äº¤æ˜“ç•Œé¢
   - æ‚¨çš„å½“å‰æŒä»“ï¼ˆå¦‚æœæœ‰ï¼‰
   - æµåŠ¨æ€§æ± ä¿¡æ¯

### 4.3 ç†è§£ä»·æ ¼æœºåˆ¶ï¼ˆé‡è¦ï¼‰

æœ¬é¡¹ç›®ä½¿ç”¨**æ’å®šä¹˜ç§¯åšå¸‚å•†ï¼ˆCPMMï¼‰**è‡ªåŠ¨å®šä»·ï¼Œæ ¸å¿ƒåŸç†ï¼š

#### ä»·æ ¼è®¡ç®—å…¬å¼

```
YESä»·æ ¼ = NOæ± å­ Ã· (YESæ± å­ + NOæ± å­)
NOä»·æ ¼ = YESæ± å­ Ã· (YESæ± å­ + NOæ± å­)
```

#### å®ä¾‹è¯´æ˜

**åˆå§‹çŠ¶æ€**ï¼š
- YESæ± å­ï¼š1000 PRED
- NOæ± å­ï¼š1000 PRED
- YESä»·æ ¼ï¼š1000 Ã· 2000 = 50%
- NOä»·æ ¼ï¼š1000 Ã· 2000 = 50%

**æ‚¨èŠ±è´¹100 PREDè´­ä¹°YESä»½é¢**ï¼š

1. ç³»ç»Ÿæ”¶å–0.5%æ‰‹ç»­è´¹ï¼š100 Ã— 0.5% = 0.5 PRED
2. å®é™…ç”¨äºäº¤æ˜“ï¼š99.5 PRED
3. 99.5 PREDåŠ å…¥NOæ± å­ï¼š1000 â†’ 1099.5
4. æ ¹æ®æ’å®šä¹˜ç§¯å…¬å¼è®¡ç®—æ‚¨è·å¾—çš„YESä»½é¢
5. YESæ± å­å‡å°‘ï¼ŒNOæ± å­å¢åŠ 
6. **ç»“æœ**ï¼šYESä»·æ ¼ä¸Šæ¶¨ï¼ŒNOä»·æ ¼ä¸‹è·Œ

**å…³é”®ç†è§£**ï¼š
- ä¹°å…¥æŸä¸ªé€‰é¡¹ â†’ è¯¥é€‰é¡¹ä»·æ ¼ä¸Šæ¶¨
- å¤§é‡ä¹°å…¥ â†’ ä»·æ ¼ä¸Šæ¶¨æ›´å¤šï¼ˆæ»‘ç‚¹æ•ˆåº”ï¼‰
- ä»·æ ¼å®æ—¶åæ˜ å¸‚åœºä¾›éœ€

### 4.4 æ‰§è¡Œä¹°å…¥äº¤æ˜“

#### æ­¥éª¤è¯¦è§£

1. **é€‰æ‹©ç«‹åœº**ï¼šç‚¹å‡» "YES" æˆ– "NO" æ ‡ç­¾

2. **è¾“å…¥é‡‘é¢**ï¼š
   - åœ¨è¾“å…¥æ¡†è¾“å…¥è¦èŠ±è´¹çš„ PRED æ•°é‡
   - ä¾‹å¦‚ï¼š`10`
   - ç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—æ‚¨å°†è·å¾—å¤šå°‘ä»½é¢

3. **æŸ¥çœ‹é¢„æœŸæ”¶ç›Š**ï¼š
   - ç•Œé¢ä¼šæ˜¾ç¤ºï¼š
     - æ‚¨å°†è·å¾—çš„ä»½é¢æ•°é‡
     - å½“å‰ä»·æ ¼
     - é¢„æœŸæœ€å¤§æ”¶ç›Šï¼ˆå¦‚æœæ‚¨é¢„æµ‹æ­£ç¡®ï¼‰
   - ç¤ºä¾‹æ˜¾ç¤ºï¼š
     ```
     èŠ±è´¹ï¼š10 PRED
     è·å¾—ï¼šçº¦ 16.5 ä»½ YES ä»½é¢
     å½“å‰YESä»·æ ¼ï¼š60%
     å¦‚æœYESè·èƒœï¼Œæ‚¨çš„æ”¶ç›Šï¼š16.5 - 10 = 6.5 PRED
     å›æŠ¥ç‡ï¼š65%
     ```

4. **è®¾ç½®æ»‘ç‚¹ä¿æŠ¤**ï¼ˆå¯é€‰ï¼‰ï¼š
   - é»˜è®¤ä¸º0%
   - å¦‚æœå¸‚åœºæ³¢åŠ¨å¤§ï¼Œå¯è®¾ç½®ä¸º1-5%
   - æ»‘ç‚¹ä¿æŠ¤ç¡®ä¿ä»·æ ¼å˜åŠ¨è¶…è¿‡è®¾å®šå€¼æ—¶äº¤æ˜“å¤±è´¥

5. **ç‚¹å‡»è´­ä¹°æŒ‰é’®**ï¼š
   - ç¬¬ä¸€æ¬¡äº¤æ˜“éœ€è¦ä¸¤æ­¥ï¼š

   **ç¬¬ä¸€æ­¥ï¼šæˆæƒï¼ˆApproveï¼‰**
   - MetaMask å¼¹å‡ºæˆæƒè¯·æ±‚
   - è¿™æ˜¯å…è®¸åˆçº¦ä½¿ç”¨æ‚¨çš„PREDä»£å¸
   - ç¡®è®¤Gasè´¹åç‚¹å‡»"ç¡®è®¤"
   - ç­‰å¾…äº¤æ˜“ç¡®è®¤ï¼ˆçº¦5-15ç§’ï¼‰

   **ç¬¬äºŒæ­¥ï¼šè´­ä¹°ï¼ˆBuyï¼‰**
   - å†æ¬¡ç‚¹å‡»è´­ä¹°æŒ‰é’®
   - MetaMask å¼¹å‡ºäº¤æ˜“è¯·æ±‚
   - ç¡®è®¤äº¤æ˜“è¯¦æƒ…å’ŒGasè´¹
   - ç‚¹å‡»"ç¡®è®¤"
   - ç­‰å¾…äº¤æ˜“ç¡®è®¤

6. **äº¤æ˜“æˆåŠŸ**ï¼š
   - é¡µé¢æ˜¾ç¤ºæˆåŠŸæç¤º
   - ä»·æ ¼ä¼šå®æ—¶æ›´æ–°
   - æ‚¨çš„æŒä»“ä¼šæ˜¾ç¤ºåœ¨ä¸‹æ–¹

#### ç¬¬ä¸€æ¬¡äº¤æ˜“ä¸ºä»€ä¹ˆéœ€è¦ä¸¤æ­¥ï¼Ÿ

è¿™æ˜¯ ERC20 ä»£å¸çš„æ ‡å‡†å®‰å…¨æœºåˆ¶ï¼š

1. **Approveï¼ˆæˆæƒï¼‰**ï¼š
   - æ‚¨å‘Šè¯‰PREDåˆçº¦ï¼š"æˆ‘å…è®¸å¸‚åœºåˆçº¦æœ€å¤šä½¿ç”¨æˆ‘çš„Xä¸ªä»£å¸"
   - è¿™æ˜¯ä¸€æ¬¡æ€§æ“ä½œï¼Œåç»­äº¤æ˜“ä¸éœ€è¦é‡å¤
   - ç±»ä¼¼äºé“¶è¡Œçš„"æˆæƒæ‰£æ¬¾"

2. **Transferï¼ˆè½¬è´¦ï¼‰**ï¼š
   - å¸‚åœºåˆçº¦æ‰§è¡Œå®é™…çš„ä»£å¸è½¬ç§»
   - åªèƒ½åœ¨æ‚¨æˆæƒçš„é¢åº¦å†…æ“ä½œ

### 4.5 æ‰§è¡Œå–å‡ºäº¤æ˜“

å¦‚æœæ‚¨æ”¹å˜ä¸»æ„æˆ–æƒ³æå‰é€€å‡ºï¼š

1. åœ¨å¸‚åœºè¯¦æƒ…é¡µé¢æ‰¾åˆ° "Sell" é€‰é¡¹
2. é€‰æ‹©è¦å–å‡ºçš„ä»½é¢ç±»å‹ï¼ˆYESæˆ–NOï¼‰
3. è¾“å…¥è¦å–å‡ºçš„ä»½é¢æ•°é‡
4. ç³»ç»Ÿæ˜¾ç¤ºæ‚¨å°†è·å¾—å¤šå°‘PRED
5. ç‚¹å‡» "Sell" æŒ‰é’®
6. åœ¨ MetaMask ç¡®è®¤äº¤æ˜“
7. ç­‰å¾…ç¡®è®¤å®Œæˆ

**æ³¨æ„**ï¼š
- å–å‡ºä¹Ÿä¼šäº§ç”Ÿ0.5%æ‰‹ç»­è´¹
- ä»·æ ¼ä¼šæ ¹æ®å¸‚åœºçŠ¶æ€å˜åŒ–
- å¦‚æœä»·æ ¼ä¸‹è·Œï¼Œæ‚¨å¯èƒ½äºæŸ

### 4.6 æŸ¥çœ‹æŒä»“

#### åœ¨å¸‚åœºè¯¦æƒ…é¡µ
å‘ä¸‹æ»šåŠ¨å¯çœ‹åˆ° "Your Position"ï¼ˆæ‚¨çš„æŒä»“ï¼‰åŒºåŸŸï¼š
- YESä»½é¢ï¼šXä»½
- NOä»½é¢ï¼šYä»½
- å½“å‰ä»·å€¼ï¼šZ PRED

#### åœ¨ Portfolio é¡µé¢
ç‚¹å‡»é¡¶éƒ¨å¯¼èˆª "Portfolio"ï¼š
- **ä½™é¢æ¦‚è§ˆ**ï¼š
  - PRED ä½™é¢
  - N ä½™é¢ï¼ˆGasè´¹ï¼‰
- **æ´»è·ƒæŒä»“**ï¼š
  - åˆ—å‡ºæ‰€æœ‰æ‚¨å‚ä¸çš„å¸‚åœº
  - æ¯ä¸ªå¸‚åœºçš„æŒä»“è¯¦æƒ…
  - ç‚¹å‡»å¯è·³è½¬åˆ°å¸‚åœºé¡µé¢
- **å†å²è®°å½•**ï¼š
  - æ‚¨çš„äº¤æ˜“å†å²
  - å·²ç»“ç®—å¸‚åœºçš„ç›ˆäº

---

## ç¬¬äº”éƒ¨åˆ†ï¼šå¸‚åœºç»“ç®—ä¸æå–æ”¶ç›Š

### 5.1 å¸‚åœºå¦‚ä½•ç»“ç®—

1. **å¸‚åœºç»“æŸ**ï¼š
   - åˆ°è¾¾é¢„è®¾çš„ç»“æŸæ—¶é—´
   - çŠ¶æ€å˜ä¸º "Ended, Waiting Resolution"

2. **ç»“æœç¡®è®¤**ï¼š
   - å¸‚åœºåˆ›å»ºè€…ç¡®è®¤å®é™…ç»“æœ
   - è°ƒç”¨ `resolveMarket` å‡½æ•°
   - æŒ‡å®š YES æˆ– NO è·èƒœ

3. **çŠ¶æ€æ›´æ–°**ï¼š
   - å¸‚åœºçŠ¶æ€å˜ä¸º "Resolved"
   - æ˜¾ç¤ºæœ€ç»ˆç»“æœ

### 5.2 æå–æ”¶ç›Š

å¦‚æœæ‚¨é¢„æµ‹æ­£ç¡®ï¼š

1. è¿›å…¥å·²ç»“ç®—çš„å¸‚åœºè¯¦æƒ…é¡µ
2. æ‰¾åˆ° "Claim Winnings"ï¼ˆæå–æ”¶ç›Šï¼‰æŒ‰é’®
3. ç‚¹å‡»æŒ‰é’®
4. MetaMask ç¡®è®¤äº¤æ˜“
5. ç­‰å¾…ç¡®è®¤
6. æˆåŠŸåï¼ŒPREDä»£å¸è½¬å…¥æ‚¨çš„é’±åŒ…

**æ”¶ç›Šè®¡ç®—**ï¼š
- æ¯ä»½è·èƒœä»½é¢ = 1 PRED
- ä¾‹å¦‚ï¼šæ‚¨æŒæœ‰10ä»½YESä»½é¢ï¼ŒYESè·èƒœ
- æ‚¨å°†è·å¾—ï¼š10 PRED

**é‡è¦**ï¼š
- å¤±è´¥çš„ä»½é¢æ²¡æœ‰ä»·å€¼
- æœªæå–çš„æ”¶ç›Šä¸€ç›´ä¿ç•™åœ¨åˆçº¦ä¸­
- å»ºè®®åŠæ—¶æå–

---

## ç¬¬å…­éƒ¨åˆ†ï¼šæµ‹è¯•åœºæ™¯

### åœºæ™¯1ï¼šå®Œæ•´äº¤æ˜“æµç¨‹

**ç›®æ ‡**ï¼šä½“éªŒå®Œæ•´çš„ä¹°å…¥ã€å–å‡ºæµç¨‹

1. ç¡®ä¿æœ‰è‡³å°‘20 PREDå’Œ0.05 N
2. è®¿é—®é¦–é¡µï¼Œé€‰æ‹©ç¤ºä¾‹å¸‚åœº
3. ä¹°å…¥10 PREDçš„YESä»½é¢
4. è§‚å¯Ÿä»·æ ¼å˜åŒ–
5. ç­‰å¾…å‡ åˆ†é’Ÿ
6. å–å‡º5ä»½YESä»½é¢
7. æ¯”è¾ƒä¹°å…¥å’Œå–å‡ºä»·æ ¼å·®å¼‚

**é¢„æœŸç»“æœ**ï¼š
- ç†è§£ä»·æ ¼å¦‚ä½•éšäº¤æ˜“å˜åŒ–
- ä½“éªŒæ‰‹ç»­è´¹çš„å½±å“
- è§‚å¯ŸæŒä»“çš„å®æ—¶æ›´æ–°

### åœºæ™¯2ï¼šä»·æ ¼å½±å“æµ‹è¯•

**ç›®æ ‡**ï¼šç†è§£äº¤æ˜“é‡å¯¹ä»·æ ¼çš„å½±å“

1. è®°å½•å½“å‰YESä»·æ ¼ï¼ˆä¾‹å¦‚ï¼š55%ï¼‰
2. ä¹°å…¥1 PREDçš„YESä»½é¢
3. è®°å½•æ–°ä»·æ ¼ï¼ˆä¾‹å¦‚ï¼š55.2%ï¼Œå°å¹…ä¸Šæ¶¨ï¼‰
4. ä¹°å…¥50 PREDçš„YESä»½é¢
5. è®°å½•æ–°ä»·æ ¼ï¼ˆä¾‹å¦‚ï¼š62%ï¼Œå¤§å¹…ä¸Šæ¶¨ï¼‰

**é¢„æœŸç»“æœ**ï¼š
- å¤§é¢äº¤æ˜“å¯¼è‡´æ›´å¤§çš„ä»·æ ¼æ»‘ç‚¹
- ç†è§£ä¸ºä»€ä¹ˆè¦åˆ†æ‰¹äº¤æ˜“

### åœºæ™¯3ï¼šå¸‚åœºåˆ›å»ºä¸ç»“ç®—

**ç›®æ ‡**ï¼šåˆ›å»ºè‡ªå·±çš„å¸‚åœºå¹¶å®Œæˆç»“ç®—

1. ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºå¸‚åœºï¼š
```bash
npm run create-market "æµ‹è¯•é—®é¢˜ï¼šæ˜å¤©ä¼šä¸‹é›¨å—ï¼Ÿ" 1 100
# å‚æ•°ï¼šé—®é¢˜ã€æŒç»­æ—¶é—´ï¼ˆå¤©ï¼‰ã€åˆå§‹æµåŠ¨æ€§
```

2. è®¿é—®æ–°å¸‚åœºï¼Œè¿›è¡Œäº¤æ˜“
3. ç­‰å¾…å¸‚åœºç»“æŸï¼ˆæµ‹è¯•ç”¨å¯è®¾ç½®çŸ­æ—¶é—´ï¼‰
4. ä½œä¸ºåˆ›å»ºè€…ç»“ç®—å¸‚åœº
5. æå–æ”¶ç›Š

**ä½¿ç”¨æ§åˆ¶å°ç»“ç®—**ï¼š
```bash
npm run console
```

```javascript
const deployment = require('./deployment.json');
const Factory = await ethers.getContractFactory("MarketFactory");
const factory = Factory.attach(deployment.factory);

// è·å–æ‰€æœ‰å¸‚åœº
const markets = await factory.getAllMarkets();
const Market = await ethers.getContractFactory("PredictionMarket");

// è¿æ¥åˆ°æ‚¨çš„å¸‚åœºï¼ˆå‡è®¾æ˜¯æœ€åä¸€ä¸ªï¼‰
const market = Market.attach(markets[markets.length - 1]);

// ç¡®è®¤æ˜¯å¦å¯ä»¥ç»“ç®—
const info = await market.getMarketInfo();
console.log("ç»“æŸæ—¶é—´:", new Date(Number(info._endTime) * 1000));
console.log("å½“å‰æ—¶é—´:", new Date());

// ç»“ç®—å¸‚åœºï¼ˆtrue = YESè·èƒœï¼Œfalse = NOè·èƒœï¼‰
await market.resolveMarket(true);
```

---

## ç¬¬ä¸ƒéƒ¨åˆ†ï¼šå¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### Q1ï¼šä¸ºä»€ä¹ˆäº¤æ˜“å¤±è´¥ï¼Ÿ

**å¯èƒ½åŸå› åŠè§£å†³æ–¹æ¡ˆ**ï¼š

1. **ä½™é¢ä¸è¶³**
   - æ£€æŸ¥ï¼šPREDä½™é¢æ˜¯å¦è¶³å¤Ÿ
   - è§£å†³ï¼šä½¿ç”¨æ°´é¾™å¤´é¢†å–æ›´å¤šPRED
   - æ£€æŸ¥å‘½ä»¤ï¼š
   ```javascript
   // åœ¨æ§åˆ¶å°ä¸­
   await token.balanceOf("YOUR_ADDRESS");
   ```

2. **Gas è´¹ä¸è¶³**
   - æ£€æŸ¥ï¼šNä»£å¸ä½™é¢
   - è§£å†³ï¼šè®¿é—®æ°´é¾™å¤´è·å–Nä»£å¸
   - MetaMaskä¼šæ˜¾ç¤º "Insufficient funds" é”™è¯¯

3. **æœªæˆæƒä»£å¸**
   - ç°è±¡ï¼šç›´æ¥ç‚¹å‡»Buyæ—¶å¤±è´¥
   - è§£å†³ï¼šå…ˆæ‰§è¡ŒApproveäº¤æ˜“

4. **æ»‘ç‚¹è¿‡å¤§**
   - ç°è±¡ï¼šæ˜¾ç¤º "Slippage limit exceeded"
   - åŸå› ï¼šä»·æ ¼å˜åŒ–è¶…è¿‡æ‚¨çš„è®¾å®š
   - è§£å†³ï¼šå¢åŠ æ»‘ç‚¹å®¹å¿åº¦æˆ–å‡å°‘äº¤æ˜“é‡‘é¢

5. **å¸‚åœºå·²ç»“æŸ**
   - ç°è±¡ï¼šæ— æ³•äº¤æ˜“
   - è§£å†³ï¼šé€‰æ‹©å…¶ä»–æ´»è·ƒå¸‚åœº

### Q2ï¼šä¸ºä»€ä¹ˆä»·æ ¼å’Œæˆ‘é¢„æœŸçš„ä¸ä¸€æ ·ï¼Ÿ

**è§£é‡Š**ï¼š

1. **CPMM è‡ªåŠ¨å®šä»·**
   - ä»·æ ¼ä¸æ˜¯å›ºå®šçš„
   - æ¯æ¬¡äº¤æ˜“éƒ½ä¼šæ”¹å˜æ± å­æ¯”ä¾‹
   - å¤§é¢äº¤æ˜“ä¼šæ˜¾è‘—å½±å“ä»·æ ¼

2. **æ‰‹ç»­è´¹å½±å“**
   - 0.5%çš„è´¹ç”¨ä¼šå‡å°‘æ‚¨è·å¾—çš„ä»½é¢
   - ä¹°å…¥å’Œå–å‡ºéƒ½æ”¶è´¹

3. **å…¶ä»–äººçš„äº¤æ˜“**
   - åœ¨æ‚¨äº¤æ˜“å‰ï¼Œå¯èƒ½æœ‰å…¶ä»–äººæ”¹å˜äº†ä»·æ ¼
   - åŒºå—é“¾ä¸Šäº¤æ˜“æœ‰å…ˆåé¡ºåº

### Q3ï¼šå¦‚ä½•è®¡ç®—æˆ‘çš„æ½œåœ¨æ”¶ç›Šï¼Ÿ

**è®¡ç®—å…¬å¼**ï¼š

1. **æœ€å¤§æ”¶ç›Š**ï¼ˆé¢„æµ‹æ­£ç¡®ï¼‰ï¼š
   ```
   æ”¶ç›Š = ä»½é¢æ•°é‡ Ã— 1 PRED - åˆå§‹æŠ•å…¥
   å›æŠ¥ç‡ = æ”¶ç›Š Ã· åˆå§‹æŠ•å…¥ Ã— 100%
   ```

   ç¤ºä¾‹ï¼š
   - æŠ•å…¥ï¼š10 PRED
   - è·å¾—ï¼š15ä»½YESä»½é¢ï¼ˆä»·æ ¼çº¦67%ï¼‰
   - å¦‚æœYESè·èƒœï¼š15 PRED
   - æ”¶ç›Šï¼š15 - 10 = 5 PRED
   - å›æŠ¥ç‡ï¼š50%

2. **æœ€åæƒ…å†µ**ï¼ˆé¢„æµ‹é”™è¯¯ï¼‰ï¼š
   ```
   æŸå¤± = åˆå§‹æŠ•å…¥
   ```

3. **æå‰å–å‡º**ï¼š
   ```
   æ”¶ç›Š/æŸå¤± = å–å‡ºè·å¾— - ä¹°å…¥èŠ±è´¹
   ```

### Q4ï¼šä¸ºä»€ä¹ˆä¸èƒ½ç«‹å³æå–æ”¶ç›Šï¼Ÿ

**åŸå› **ï¼š

1. **å¸‚åœºå°šæœªç»“æŸ**
   - éœ€è¦ç­‰åˆ° endTime
   - æŸ¥çœ‹å€’è®¡æ—¶

2. **å¸‚åœºæœªç»“ç®—**
   - ç»“æŸåéœ€è¦åˆ›å»ºè€…ç¡®è®¤ç»“æœ
   - çŠ¶æ€ä¸º "Ended" ä½†ä¸æ˜¯ "Resolved"

3. **æ‚¨é¢„æµ‹é”™è¯¯**
   - åªæœ‰è·èƒœæ–¹çš„ä»½é¢æœ‰ä»·å€¼
   - å¤±è´¥æ–¹ä»½é¢å½’é›¶

### Q5ï¼šæ°´é¾™å¤´æ˜¾ç¤º"è¯·24å°æ—¶åå†è¯•"æ€ä¹ˆåŠï¼Ÿ

**åŸå› **ï¼š
- æ¯ä¸ªåœ°å€æ¯24å°æ—¶åªèƒ½é¢†å–ä¸€æ¬¡100 PRED

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. **ç­‰å¾…**ï¼š
   - æŸ¥çœ‹è¿˜éœ€è¦ç­‰å¾…å¤šä¹…ï¼š
   ```javascript
   const timeLeft = await token.faucetTimeLeft("YOUR_ADDRESS");
   console.log("è¿˜éœ€ç­‰å¾…ï¼ˆç§’ï¼‰:", timeLeft.toString());
   ```

2. **ä½¿ç”¨å¦ä¸€ä¸ªåœ°å€**ï¼š
   - åœ¨ MetaMask åˆ›å»ºæ–°è´¦æˆ·
   - åˆ‡æ¢è´¦æˆ·åé‡æ–°é¢†å–

3. **å‘å…¶ä»–äººè¯·æ±‚**ï¼š
   - è®©æœ‹å‹ä»æ°´é¾™å¤´é¢†å–åè½¬ç»™æ‚¨

### Q6ï¼šäº¤æ˜“å¡ä½äº†æ€ä¹ˆåŠï¼Ÿ

**ç°è±¡**ï¼š
- MetaMask æ˜¾ç¤º "Pending"ï¼ˆå¾…å¤„ç†ï¼‰å¾ˆé•¿æ—¶é—´

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. **ç­‰å¾…**ï¼š
   - N42æµ‹è¯•ç½‘çš„åŒºå—æ—¶é—´çº¦10-30ç§’
   - é€šå¸¸1åˆ†é’Ÿå†…ä¼šç¡®è®¤

2. **æ£€æŸ¥åŒºå—æµè§ˆå™¨**ï¼š
   - è®¿é—®ï¼šhttps://testnet.n42.world/
   - æœç´¢æ‚¨çš„é’±åŒ…åœ°å€
   - æŸ¥çœ‹äº¤æ˜“çŠ¶æ€

3. **Gas è´¹å¤ªä½**ï¼š
   - åœ¨ MetaMask ä¸­åŠ é€Ÿäº¤æ˜“
   - æˆ–å–æ¶ˆåé‡æ–°å‘é€

### Q7ï¼šå¦‚ä½•æŸ¥çœ‹æˆ‘çš„äº¤æ˜“å†å²ï¼Ÿ

**æ–¹æ³•1ï¼šä½¿ç”¨åŒºå—æµè§ˆå™¨**
1. è®¿é—®ï¼šhttps://testnet.n42.world/
2. æœç´¢æ‚¨çš„é’±åŒ…åœ°å€
3. æŸ¥çœ‹æ‰€æœ‰äº¤æ˜“è®°å½•

**æ–¹æ³•2ï¼šä½¿ç”¨å‰ç«¯ Portfolio é¡µé¢**
1. ç‚¹å‡»é¡¶éƒ¨ "Portfolio"
2. æŸ¥çœ‹ "Transaction History" åŒºåŸŸ

**æ–¹æ³•3ï¼šä½¿ç”¨æ§åˆ¶å°**
```javascript
// æŸ¥è¯¢å¸‚åœºäº‹ä»¶
const events = await market.queryFilter(market.filters.SharesPurchased());
console.log(events);
```

### Q8ï¼šåˆ›å»ºå¸‚åœºéœ€è¦ä»€ä¹ˆæ¡ä»¶ï¼Ÿ

**è¦æ±‚**ï¼š

1. **æœ€ä½æµåŠ¨æ€§**ï¼š100 PRED
2. **æœ€çŸ­æŒç»­æ—¶é—´**ï¼š1å°æ—¶
3. **è¶³å¤Ÿçš„ä½™é¢**ï¼š
   - PREDï¼šè‡³å°‘ 200ï¼ˆåˆå§‹æµåŠ¨æ€§çš„2å€ï¼‰
   - Nï¼šè‡³å°‘ 0.05ï¼ˆGasè´¹ï¼‰

**åˆ›å»ºå‘½ä»¤**ï¼š
```bash
npm run create-market "æ‚¨çš„é—®é¢˜ï¼Ÿ" æŒç»­å¤©æ•° åˆå§‹æµåŠ¨æ€§
```

ç¤ºä¾‹ï¼š
```bash
npm run create-market "ETHä¼šåœ¨7å¤©å†…çªç ´$4000å—ï¼Ÿ" 7 200
```

---

## ç¬¬å…«éƒ¨åˆ†ï¼šå®‰å…¨æ³¨æ„äº‹é¡¹

### 8.1 åŸºæœ¬å®‰å…¨åŸåˆ™

1. **è¿™æ˜¯æµ‹è¯•ç½‘ç¯å¢ƒ**
   - æ‰€æœ‰ä»£å¸éƒ½æ˜¯æµ‹è¯•ç”¨é€”ï¼Œæ²¡æœ‰å®é™…ä»·å€¼
   - ä¸è¦åœ¨æµ‹è¯•ç½‘é’±åŒ…ä¸­å­˜æ”¾çœŸå®èµ„äº§
   - å¯ä»¥å¤§èƒ†å°è¯•ï¼Œä¸ç”¨æ‹…å¿ƒçœŸå®æŸå¤±

2. **ç§é’¥å®‰å…¨**
   - æ°¸è¿œä¸è¦åˆ†äº«æ‚¨çš„ç§é’¥æˆ–åŠ©è®°è¯
   - å³ä½¿æ˜¯æµ‹è¯•ç½‘ï¼Œä¹Ÿè¦å…»æˆè‰¯å¥½ä¹ æƒ¯
   - ä¸è¦åœ¨å…¬å…±ç”µè„‘ä¸Šä½¿ç”¨é’±åŒ…

3. **äº¤æ˜“ç¡®è®¤**
   - æ¯æ¬¡äº¤æ˜“å‰æ£€æŸ¥ MetaMask çš„è¯¦æƒ…
   - ç¡®è®¤åˆçº¦åœ°å€æ­£ç¡®
   - ç¡®è®¤äº¤æ˜“é‡‘é¢æ— è¯¯

### 8.2 é¡¹ç›®ç‰¹å®šçš„å®‰å…¨è€ƒè™‘

1. **å¸‚åœºç»“ç®—çš„ä¸­å¿ƒåŒ–é£é™©**
   - å½“å‰ç‰ˆæœ¬ä¸­ï¼Œå¸‚åœºåˆ›å»ºè€…å®Œå…¨æ§åˆ¶ç»“æœ
   - åˆ›å»ºè€…å¯ä»¥ä¸è¯šå®åœ°ç»“ç®—
   - **å»ºè®®**ï¼šåªå‚ä¸å¯ä¿¡ä»»åˆ›å»ºè€…çš„å¸‚åœº

2. **æ— äº‰è®®è§£å†³æœºåˆ¶**
   - ä¸€æ—¦ç»“ç®—ï¼Œç»“æœæ— æ³•æ›´æ”¹
   - æ²¡æœ‰ç”³è¯‰æµç¨‹
   - **å»ºè®®**ï¼šè°¨æ…é€‰æ‹©å‚ä¸çš„å¸‚åœº

3. **å‰ç½®äº¤æ˜“é£é™©**
   - æ‚¨çš„äº¤æ˜“åœ¨åŒºå—é“¾ä¸Šå…¬å¼€å¯è§
   - ä»–äººå¯èƒ½çœ‹åˆ°åæŠ¢å…ˆäº¤æ˜“
   - **å½±å“**ï¼šä»·æ ¼å¯èƒ½åœ¨æ‚¨äº¤æ˜“å‰è¢«æ”¹å˜

4. **æ™ºèƒ½åˆçº¦é£é™©**
   - åˆçº¦ä»£ç å·²å¼€æºï¼Œä½†æœªç»ä¸“ä¸šå®¡è®¡
   - å¯èƒ½å­˜åœ¨æœªå‘ç°çš„æ¼æ´
   - **å»ºè®®**ï¼šä¸è¦åœ¨ä¸»ç½‘ä½¿ç”¨æœªå®¡è®¡çš„ä»£ç 

### 8.3 æœ€ä½³å®è·µ

1. **åˆ†æ‰¹äº¤æ˜“**
   - å¤§é¢äº¤æ˜“åˆ†æˆå¤šä¸ªå°é¢
   - å‡å°‘ä»·æ ¼æ»‘ç‚¹
   - é™ä½å•æ¬¡é£é™©

2. **è®¾ç½®æ»‘ç‚¹ä¿æŠ¤**
   - å¯¹äºæµåŠ¨æ€§ä½çš„å¸‚åœºï¼Œè®¾ç½®1-5%æ»‘ç‚¹
   - é˜²æ­¢ä»·æ ¼å‰§çƒˆå˜åŒ–æ—¶çš„æŸå¤±

3. **åŠæ—¶æå–æ”¶ç›Š**
   - å¸‚åœºç»“ç®—åå°½å¿«æå–
   - é¿å…é•¿æœŸé”å®šåœ¨åˆçº¦ä¸­

4. **ç›‘æ§Gasè´¹**
   - æµ‹è¯•ç½‘Gasè´¹é€šå¸¸å¾ˆä½
   - ä½†è¦ç¡®ä¿ä½™é¢è¶³å¤Ÿ

---

## ç¬¬ä¹éƒ¨åˆ†ï¼šé«˜çº§åŠŸèƒ½

### 9.1 ä½¿ç”¨ Hardhat æ§åˆ¶å°

å¯¹äºæƒ³è¦æ›´æ·±å…¥æ¢ç´¢çš„ç”¨æˆ·ï¼š

1. **è¿›å…¥æ§åˆ¶å°**ï¼š
```bash
cd /Users/jieliu/Documents/n42/PredictionMarketDemo
npm run console
```

2. **å¸¸ç”¨æ“ä½œ**ï¼š

**æŸ¥çœ‹å¸‚åœºä¿¡æ¯**ï¼š
```javascript
const deployment = require('./deployment.json');
const Factory = await ethers.getContractFactory("MarketFactory");
const factory = Factory.attach(deployment.factory);

// è·å–æ‰€æœ‰å¸‚åœº
const markets = await factory.getAllMarkets();
console.log("å¸‚åœºæ•°é‡:", markets.length);

// è¿æ¥åˆ°ç¬¬ä¸€ä¸ªå¸‚åœº
const Market = await ethers.getContractFactory("PredictionMarket");
const market = Market.attach(markets[0]);

// è·å–å¸‚åœºè¯¦æƒ…
const info = await market.getMarketInfo();
console.log("é—®é¢˜:", info._question);
console.log("YESä»·æ ¼:", ethers.formatEther(info._yesPrice));
console.log("NOä»·æ ¼:", ethers.formatEther(info._noPrice));
```

**æŸ¥çœ‹æŒä»“**ï¼š
```javascript
const signers = await ethers.getSigners();
const myAddress = signers[0].address;

const position = await market.getUserPosition(myAddress);
console.log("YESä»½é¢:", ethers.formatEther(position._yesShares));
console.log("NOä»½é¢:", ethers.formatEther(position._noShares));
```

**æ¨¡æ‹Ÿäº¤æ˜“è®¡ç®—**ï¼š
```javascript
// è®¡ç®—ä¹°å…¥10 PREDçš„YESä»½é¢èƒ½è·å¾—å¤šå°‘ä»½é¢
const sharesOut = await market.calculateSharesOut(
    ethers.parseEther("10"),
    true  // true = YES, false = NO
);
console.log("å°†è·å¾—ä»½é¢:", ethers.formatEther(sharesOut));

// è®¡ç®—å–å‡º5ä»½YESä»½é¢èƒ½è·å¾—å¤šå°‘PRED
const amountOut = await market.calculateAmountOut(
    ethers.parseEther("5"),
    true
);
console.log("å°†è·å¾—PRED:", ethers.formatEther(amountOut));
```

### 9.2 ç›‘å¬å¸‚åœºäº‹ä»¶

**å®æ—¶ç›‘å¬äº¤æ˜“**ï¼š
```javascript
// ç›‘å¬è´­ä¹°äº‹ä»¶
market.on("SharesPurchased", (buyer, isYes, amountIn, sharesOut) => {
    console.log("æ–°äº¤æ˜“ï¼");
    console.log("ä¹°å®¶:", buyer);
    console.log("ç±»å‹:", isYes ? "YES" : "NO");
    console.log("é‡‘é¢:", ethers.formatEther(amountIn));
    console.log("ä»½é¢:", ethers.formatEther(sharesOut));
});

// åœæ­¢ç›‘å¬
market.removeAllListeners("SharesPurchased");
```

### 9.3 æ‰¹é‡æŸ¥è¯¢å¸‚åœº

**æŸ¥è¯¢æ‰€æœ‰å¸‚åœºçŠ¶æ€**ï¼š
```javascript
async function queryAllMarkets() {
    const deployment = require('./deployment.json');
    const Factory = await ethers.getContractFactory("MarketFactory");
    const factory = Factory.attach(deployment.factory);

    const markets = await factory.getAllMarkets();
    const Market = await ethers.getContractFactory("PredictionMarket");

    for (let i = 0; i < markets.length; i++) {
        const market = Market.attach(markets[i]);
        const info = await market.getMarketInfo();

        console.log(`\nå¸‚åœº ${i + 1}:`);
        console.log("é—®é¢˜:", info._question);
        console.log("YESä»·æ ¼:", (Number(info._yesPrice) / 1e18 * 100).toFixed(2) + "%");
        console.log("NOä»·æ ¼:", (Number(info._noPrice) / 1e18 * 100).toFixed(2) + "%");
        console.log("çŠ¶æ€:", info._resolved ? "å·²ç»“ç®—" : "æ´»è·ƒ");
        if (info._resolved) {
            console.log("ç»“æœ:", info._outcome ? "YESè·èƒœ" : "NOè·èƒœ");
        }
    }
}

await queryAllMarkets();
```

---

## ç¬¬åéƒ¨åˆ†ï¼šæ•…éšœæ’é™¤é€ŸæŸ¥è¡¨

| é—®é¢˜ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|---------|---------|
| è¿æ¥é’±åŒ…å¤±è´¥ | MetaMaskæœªå®‰è£… | å®‰è£… MetaMask æ‰©å±• |
| æ— æ³•çœ‹åˆ°å¸‚åœº | ç½‘ç»œé”™è¯¯ | åˆ‡æ¢åˆ°N42æµ‹è¯•ç½‘ |
| äº¤æ˜“å¤±è´¥ï¼šInsufficient funds | ä½™é¢ä¸è¶³ | è·å–æµ‹è¯•ä»£å¸ |
| äº¤æ˜“å¤±è´¥ï¼šExecution reverted | å„ç§åˆçº¦é”™è¯¯ | æŸ¥çœ‹å…·ä½“é”™è¯¯ä¿¡æ¯ |
| ä»·æ ¼æ˜¾ç¤ºå¼‚å¸¸ | å‰ç«¯è¿æ¥é—®é¢˜ | åˆ·æ–°é¡µé¢ï¼Œé‡æ–°è¿æ¥é’±åŒ… |
| æ— æ³•é¢†å–æ°´é¾™å¤´ | å†·å´æœŸæœªè¿‡ | ç­‰å¾…24å°æ—¶ |
| Approveäº¤æ˜“åä»æ— æ³•ä¹°å…¥ | Approveé‡‘é¢ä¸è¶³ | å†æ¬¡Approveæ›´å¤§é‡‘é¢ |
| äº¤æ˜“pendingå¾ˆä¹… | Gasä»·æ ¼å¤ªä½æˆ–ç½‘ç»œæ‹¥å µ | ç­‰å¾…æˆ–åŠ é€Ÿäº¤æ˜“ |

---

## ç¬¬åä¸€éƒ¨åˆ†ï¼šå­¦ä¹ èµ„æº

### äº†è§£é¢„æµ‹å¸‚åœº

1. **Polymarket æ–‡æ¡£**ï¼šhttps://docs.polymarket.com/
   - å­¦ä¹ çœŸå®é¢„æµ‹å¸‚åœºçš„è¿ä½œ

2. **é¢„æµ‹å¸‚åœºç†è®º**ï¼š
   - ç»´åŸºç™¾ç§‘ï¼šPrediction Market
   - äº†è§£ç»æµå­¦åŸç†

### äº†è§£ CPMMï¼ˆæ’å®šä¹˜ç§¯åšå¸‚å•†ï¼‰

1. **Uniswap V2 ç™½çš®ä¹¦**ï¼š
   - ç›¸åŒçš„å®šä»·æœºåˆ¶
   - https://uniswap.org/whitepaper.pdf

2. **AMM æ•™ç¨‹**ï¼š
   - æœç´¢ "Automated Market Maker tutorial"

### åŒºå—é“¾å¼€å‘

1. **Solidity æ–‡æ¡£**ï¼šhttps://docs.soliditylang.org/
2. **Hardhat æ–‡æ¡£**ï¼šhttps://hardhat.org/
3. **ethers.js æ–‡æ¡£**ï¼šhttps://docs.ethers.org/

---

## ç¬¬åäºŒéƒ¨åˆ†ï¼šæ€»ç»“ä¸ä¸‹ä¸€æ­¥

### æ‚¨å·²ç»å­¦ä¼šäº†

âœ… é¢„æµ‹å¸‚åœºçš„åŸºæœ¬åŸç†å’Œè¿ä½œæ–¹å¼
âœ… å¦‚ä½•é…ç½® MetaMask è¿æ¥ N42 æµ‹è¯•ç½‘
âœ… å¦‚ä½•è·å–å’Œç®¡ç†æµ‹è¯•ä»£å¸
âœ… å¦‚ä½•æµè§ˆå¸‚åœºå’Œç†è§£ä»·æ ¼
âœ… å¦‚ä½•æ‰§è¡Œä¹°å…¥å’Œå–å‡ºäº¤æ˜“
âœ… å¦‚ä½•æŸ¥çœ‹æŒä»“å’Œæå–æ”¶ç›Š
âœ… å¦‚ä½•è§£å†³å¸¸è§é—®é¢˜

### å»ºè®®çš„å­¦ä¹ è·¯å¾„

1. **åˆå­¦è€…**ï¼š
   - å…ˆç”¨å°‘é‡ä»£å¸ï¼ˆ1-5 PREDï¼‰è¿›è¡Œäº¤æ˜“
   - è§‚å¯Ÿä»·æ ¼å˜åŒ–
   - ç†è§£æ‰‹ç»­è´¹å½±å“
   - ä½“éªŒå®Œæ•´çš„å¸‚åœºå‘¨æœŸ

2. **è¿›é˜¶ç”¨æˆ·**ï¼š
   - å°è¯•åˆ›å»ºè‡ªå·±çš„å¸‚åœº
   - ä½¿ç”¨æ§åˆ¶å°è¿›è¡Œé«˜çº§æ“ä½œ
   - åˆ†æä¸åŒç­–ç•¥çš„ç›ˆäº
   - ç ”ç©¶æ™ºèƒ½åˆçº¦ä»£ç 

3. **å¼€å‘è€…**ï¼š
   - é˜…è¯»æ™ºèƒ½åˆçº¦æºä»£ç 
   - è¿è¡Œæµ‹è¯•å¥—ä»¶ï¼š`npm test`
   - ä¿®æ”¹å‚æ•°å¹¶é‡æ–°éƒ¨ç½²
   - ä¸ºé¡¹ç›®è´¡çŒ®ä»£ç 

### è¿›ä¸€æ­¥æ¢ç´¢

- **æµ‹è¯•ä¸åŒåœºæ™¯**ï¼šåˆ›å»ºå„ç§ç±»å‹çš„é¢„æµ‹é—®é¢˜
- **åˆ†æå¸‚åœºæ•ˆç‡**ï¼šè§‚å¯Ÿä»·æ ¼æ˜¯å¦åˆç†åæ˜ æ¦‚ç‡
- **ç­–ç•¥å¼€å‘**ï¼šå°è¯•ä¸åŒçš„äº¤æ˜“ç­–ç•¥
- **å‰ç«¯å®šåˆ¶**ï¼šä¿®æ”¹å‰ç«¯ç•Œé¢ä»¥æ»¡è¶³éœ€æ±‚

---

## é™„å½•ï¼šé‡è¦åˆçº¦åœ°å€

```
PredictionToken (PRED):
0x38A70c040CA5F5439ad52d0e821063b0EC0B52b6

MarketFactory:
0x54B8d8E2455946f2A5B8982283f2359812e815ce

ç¤ºä¾‹å¸‚åœº:
0x6B2031b6519268e623CA05F3683708Ed6C6F89df
```

**åŒºå—æµè§ˆå™¨é“¾æ¥**ï¼š
- Token: https://testnet.n42.world/address/0x38A70c040CA5F5439ad52d0e821063b0EC0B52b6
- Factory: https://testnet.n42.world/address/0x54B8d8E2455946f2A5B8982283f2359812e815ce

---

## è”ç³»ä¸æ”¯æŒ

- **é¡¹ç›® GitHub**ï¼šæŸ¥çœ‹æºä»£ç å’Œæäº¤é—®é¢˜
- **N42 Discord**ï¼šåŠ å…¥ç¤¾åŒºè®¨è®º
- **N42 æ–‡æ¡£**ï¼šhttps://n42.ai/

---

**ç¥æ‚¨åœ¨é¢„æµ‹å¸‚åœºçš„æ¢ç´¢ä¹‹æ—…ä¸­è·å¾—ä¹è¶£å’Œæ”¶è·ï¼** ğŸ¯

*æœ€åæ›´æ–°ï¼š2026-01-19*
